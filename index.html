<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Vendas</title>
    <!-- jQuery primeiro -->
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    
    <!-- Bootstrap CSS e JS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.2/css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.2/js/bootstrap.bundle.min.js"></script>
    
    <!-- Multiselect CSS e JS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/1.1.2/css/bootstrap-multiselect.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/1.1.2/js/bootstrap-multiselect.js"></script>
    
    <!-- Outros scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.css">
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.dataTables.min.css">
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
    
    <!-- Flatpickr -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" type="text/css" href="https://npmcdn.com/flatpickr/dist/themes/dark.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/pt.js"></script>
    
    <!-- Fontes Google para a tela de login -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="style.css">
    
    <!-- Multiselect CSS e JS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/1.1.2/css/bootstrap-multiselect.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/1.1.2/js/bootstrap-multiselect.js"></script>
    
    <!-- Outros scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.css">
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.js"></script>

    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.dataTables.min.css">
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
<link rel="stylesheet" href="style.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
<link rel="stylesheet" href="style.css">
<style>
    #company-logo {
        height: 70px; /* Ajuste a altura do logo aqui */
        width: auto;
    }

    /* Estilos do seletor de datas */
    .date-range-container {
        position: relative;
    }

    .date-range-input {
        width: 100%;
        padding: 10px 15px;
        background-color: #343a40;
        border: 1px solid #495057;
        border-radius: 4px;
        color: #fff;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .date-range-input:hover {
        border-color: #6c757d;
    }

    .date-range-input:focus {
        outline: none;
        border-color: #ffc107;
        box-shadow: 0 0 0 2px rgba(255, 193, 7, 0.25);
    }

    /* Customiza√ß√£o do Flatpickr */
    .flatpickr-calendar {
        border: none !important;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
    }

    .flatpickr-day.selected {
        background: #ffc107 !important;
        border-color: #ffc107 !important;
        color: #000 !important;
    }

    .flatpickr-day.inRange {
        background: rgba(255, 193, 7, 0.2) !important;
        border-color: transparent !important;
        color: #fff !important;
    }

    .flatpickr-day:hover {
        background: rgba(255, 193, 7, 0.3) !important;
    }
</style>

</head>
<body>
    <div id="login-overlay">
        <div id="login-container">
            <h1 class="page-title">Dashboard de Vendas</h1>
            <section class="access-control" id="access-section">
                <label for="access-code">Digite seu Login de Acesso</label>
                <input type="text" id="access-code" maxlength="20" placeholder="Insira seu login">
                <button id="submit-code">Liberar Acesso</button>
                <p id="error-message">Login inv√°lido!</p>
            </section>
            <img id="company-logo-login" src="logo_viva.png" alt="Logo Viva Eventos">
        </div>
    </div>

    <div class="dashboard-wrapper" style="display: none;">
        <!-- Bot√£o do menu lateral corrigido -->
        <button id="sidebar-toggle"><span class="arrow-icon"></span></button>
        
        <div id="sidebar">
            <div class="page-navigation">
                <a href="https://central-dashs-viva-html.vercel.app/" class="page-navigation-button" id="return-to-hub-link"><button>Central de Dashboards VIVA Eventos</button></a>
                <hr>
                <button id="btn-page1" class="active" data-page="page1">Metas e Resultados</button>
                <button id="btn-page2" data-page="page2">Indicadores Secund√°rios</button>
                <button id="btn-page3" data-page="page3">Funil de Vendas</button>
            </div>

            <section id="loader" class="filters">
                <div class="loader-container">
                    <div class="css-loader">
                        <div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div>
                    </div>
                    <div class="loader-text">Carregando dados...</div>
                </div>
            </section>

            <section class="filters" id="filters-section" style="display: none;">
                <div class="filter-item date-range-container">
                    <label class="filter-label">üìÖ Per√≠odo</label>
                    <input type="text" id="date-range" class="date-range-input" placeholder="Selecione o per√≠odo" readonly>
                    <input type="hidden" id="start-date">
                    <input type="hidden" id="end-date">
                </div>
                <div class="filter-item filter-item-unidades">
                    <label class="filter-label">üè¢ Unidades</label>
                    <select id="unidade-filter" multiple="multiple"></select>
                </div>
                <div class="filter-item" id="curso-filter-container">
                    <label class="filter-label">üìö Cursos</label>
                    <select id="curso-filter" multiple="multiple"></select>
                </div>
                <div class="filter-item" id="fundo-filter-container">
                    <label class="filter-label">üí∞ Fundos</label>
                    <select id="fundo-filter" multiple="multiple"></select>
                </div>
            </section>
        </div>
        <div id="main-content">
            <div class="container">
                <header class="header">
                    <div>
                        <h1>Dashboard de Vendas e Metas</h1>
                        <span id="last-update-message"></span>
                    </div>
                    <img id="company-logo" src="logo_viva.png" alt="Logo da Empresa">
                </header>
                <div id="page1" class="page-content active">
                    <section class="kpi-container" id="kpi-section" style="display: none;">
                        <div class="kpi-main-wrapper">
                            <div class="kpi-main-cards-container">
                                <div class="kpi-main-card">
                                    <span class="kpi-card-title">REALIZADO TOTAL</span>
                                    <span class="kpi-card-value" id="kpi-total-realizado">R$ 0,00</span>
                                    <span class="kpi-card-details"><span class="percent" id="kpi-total-percent">0,0%</span> de <span id="kpi-total-meta">R$ 0,00</span> META TOTAL</span>
                                    <div class="progress-bar-bg"><div class="progress-bar-fg" id="kpi-total-progress"></div></div>
                                </div>
                                <div class="kpi-main-card">
                                    <span class="kpi-card-title">REALIZADO VENDAS</span>
                                    <span class="kpi-card-value" id="kpi-vendas-realizado">R$ 0,00</span>
                                    <span class="kpi-card-details"><span class="percent" id="kpi-vendas-percent">0,0%</span> de <span id="kpi-vendas-meta">R$ 0,00</span> META VENDAS</span>
                                    <div class="progress-bar-bg"><div class="progress-bar-fg" id="kpi-vendas-progress"></div></div>
                                </div>
                                <div class="kpi-main-card">
                                    <span class="kpi-card-title">REALIZADO P√ìS VENDAS</span>
                                    <span class="kpi-card-value" id="kpi-posvendas-realizado">R$ 0,00</span>
                                    <span class="kpi-card-details"><span class="percent" id="kpi-posvendas-percent">0,0%</span> de <span id="kpi-posvendas-meta">R$ 0,00</span> META P√ìS VENDAS</span>
                                    <div class="progress-bar-bg"><div class="progress-bar-fg" id="kpi-posvendas-progress"></div></div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section class="kpi-container" id="kpi-section-py" style="display: none;">
                        <h2 style="grid-column: span 12; font-size: 1.2em; border-bottom: none; padding-bottom: 0;">Desempenho no Per√≠odo Anterior</h2>
                        <div class="kpi-main-wrapper" style="width: 100%; grid-column: span 12;">
                            <div class="kpi-main-cards-container">
                                <div class="kpi-main-card">
                                    <span class="kpi-card-title">REALIZADO TOTAL</span>
                                    <span class="kpi-card-value" id="kpi-total-realizado-py">R$ 0,00</span>
                                    <span class="kpi-card-details"><span class="percent" id="kpi-total-percent-py">0,0%</span> de <span id="kpi-total-meta-py">R$ 0,00</span> META TOTAL</span>
                                    <div class="progress-bar-bg"><div class="progress-bar-fg" id="kpi-total-progress-py"></div></div>
                                </div>
                                <div class="kpi-main-card">
                                    <span class="kpi-card-title">REALIZADO VENDAS</span>
                                    <span class="kpi-card-value" id="kpi-vendas-realizado-py">R$ 0,00</span>
                                    <span class="kpi-card-details"><span class="percent" id="kpi-vendas-percent-py">0,0%</span> de <span id="kpi-vendas-meta-py">R$ 0,00</span> META VENDAS</span>
                                    <div class="progress-bar-bg"><div class="progress-bar-fg" id="kpi-vendas-progress-py"></div></div>
                                </div>
                                <div class="kpi-main-card">
                                    <span class="kpi-card-title">REALIZADO P√ìS VENDAS</span>
                                    <span class="kpi-card-value" id="kpi-posvendas-realizado-py">R$ 0,00</span>
                                    <span class="kpi-card-details"><span class="percent" id="kpi-posvendas-percent-py">0,0%</span> de <span id="kpi-posvendas-meta-py">R$ 0,00</span> META P√ìS VENDAS</span>
                                    <div class="progress-bar-bg"><div class="progress-bar-fg" id="kpi-posvendas-progress-py"></div></div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section class="chart-container" id="chart-vvr-mes-section" style="display: none;">
                        <h2>VVR Realizado vs. Meta por M√™s (Ano Vigente)</h2>
                        <div class="chart-selector">
                            <button id="btn-total" class="active" data-type="total">Total</button>
                            <button id="btn-vendas" data-type="vendas">Vendas</button>
                            <button id="btn-posvendas" data-type="posvendas">P√≥s Venda</button>
                        </div>
                        <div class="chart-wrapper">
                            <canvas id="vvrVsMetaPorMesChart"></canvas>
                        </div>
                    </section>
                    <section class="chart-container" id="chart-cumulative-section" style="display: none;">
                        <h2>VVR Acumulado Anual (Comparativo)</h2>
                        <div class="chart-selector" id="cumulative-chart-selector"></div>
                        <div class="chart-wrapper">
                            <canvas id="cumulativeVvrChart"></canvas>
                        </div>
                    </section>
                    <section class="table-container" id="table-section" style="display: none;">
                        <h2>Dados Detalhados por M√™s/Unidade (Per√≠odo Selecionado)</h2>
                        <div class="chart-selector">
                            <button class="active" data-type="total">Total</button>
                            <button data-type="vendas">Vendas</button>
                            <button data-type="posvendas">P√≥s Venda</button>
                        </div>
                        <table id="dados-table" class="display" style="width:100%">
                            <thead><tr><th>Unidade</th><th>Per√≠odo</th><th>VVR Realizado</th><th>Meta VVR</th><th>Atingimento VVR</th></tr></thead>
                            <tbody></tbody>
                            <tfoot></tfoot>
                        </table>
                    </section>
                </div>
                <div id="page2" class="page-content">
                    <section class="chart-container" id="chart-monthly-vvr-section" style="display: none;">
                        <h2>Comparativo de VVR Mensal</h2>
                        <div class="chart-selector" id="monthly-chart-selector"></div>
                        <div class="chart-wrapper">
                           <canvas id="monthlyVvrChart"></canvas>
                        </div>
                    </section>
                    <div class="chart-row-adesoes">
                        <div class="chart-container" id="chart-yearly-stacked-section" style="display: none;">
                            <h2>Venda Realizada Total Anual</h2>
                            <div class="chart-wrapper">
                                <canvas id="yearlyStackedChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-container" id="chart-monthly-stacked-section" style="display: none;">
                            <h2 id="monthly-stacked-title">Venda Realizada Total Mensal</h2>
                            <div class="chart-wrapper">
                                <canvas id="monthlyStackedChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="chart-row-adesoes">
                        <div class="chart-container" id="chart-yearly-ticket-section" style="display: none;">
                            <h2>Ticket M√©dio Anual</h2>
                            <div class="chart-wrapper">
                                <canvas id="yearlyTicketChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-container" id="chart-monthly-ticket-section" style="display: none;">
                            <h2 id="monthly-ticket-title">Ticket M√©dio Mensal</h2>
                            <div class="chart-wrapper">
                                <canvas id="monthlyTicketChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="chart-row-adesoes">
                        <div class="chart-container" id="chart-yearly-contracts-section" style="display: none;">
                            <h2>Contratos Realizados Total Anual</h2>
                            <div class="chart-wrapper">
                                <canvas id="yearlyContractsChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-container" id="chart-monthly-contracts-section" style="display: none;">
                            <h2 id="monthly-contracts-title">Contratos Realizados Total Mensal</h2>
                            <div class="chart-wrapper">
                                <canvas id="monthlyContractsChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <section class="chart-container" id="chart-monthly-adesoes-section" style="display: block;">
                        <h2>Comparativo Mensal de Ades√µes</h2>
                        <div class="chart-selector" id="adesoes-chart-selector"></div>
                        <div class="chart-wrapper">
                           <canvas id="monthlyAdesoesChart"></canvas>
                        </div>
                    </section>
                    <div class="chart-row-adesoes">
                        <div class="chart-container" id="chart-yearly-adesoes-stacked-section" style="display: none;">
                            <h2>Ades√µes por Tipo (Anual)</h2>
                            <div class="chart-wrapper">
                                <canvas id="yearlyAdesoesStackedChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-container" id="chart-monthly-adesoes-stacked-section" style="display: none;">
                            <h2 id="monthly-adesoes-stacked-title">Ades√µes por Tipo (Mensal)</h2>
                            <div class="chart-wrapper">
                                <canvas id="monthlyAdesoesStackedChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <section class="table-container" id="consultor-table-section" style="display: none;">
                        <h2>Desempenho por Consultor Comercial</h2>
                        <table id="consultor-table" class="display" style="width:100%">
                            <thead>
                                <tr>
                                    <th>Unidade</th>
                                    <th>Consultor Comercial</th>
                                    <th>VVR Total</th>
                                    <th>Total de Ades√µes</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </section>
                    <section class="table-container" id="detalhada-adesoes-table-section" style="display: none;">
                        <h2>Ades√µes Detalhadas no Per√≠odo</h2>
                        <table id="detalhada-adesoes-table" class="display" style="width:100%">
                            <thead>
                                <tr>
                                    <th>Unidade</th>
                                    <th>C√≥d. Integrante</th>
                                    <th>Integrante</th>
                                    <th>Data Cadastro</th>
                                    <th>C√≥d. Fundo</th>
                                    <th>Tipo</th>
                                    <th>Consultor</th>
                                    <th>VVR</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </section>
                    <section class="table-container" id="fundos-detalhados-table-section" style="display: none;">
                        <h2>Fundos Detalhados no Per√≠odo</h2>
                        <table id="fundos-detalhados-table" class="display" style="width:100%">
                            <thead>
                                <tr>
                                    <th>Unidade</th>
                                    <th>ID Fundo</th>
                                    <th>Fundo</th>
                                    <th>DT Contrato</th>
                                    <th>DT Cadastro</th>
                                    <th>Tipo de Servi√ßo</th>
                                    <th>Institui√ß√£o</th>
                                    <th>DT Baile</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </section>
                </div>
                <div id="page3" class="page-content">
                    <!-- Indicadores Operacionais do Funil -->
                    <section class="kpi-container" id="funil-indicators-section" style="display: block;">
                        <h2 style="grid-column: span 12; font-size: 1.4em; color: #ffc107; margin-bottom: 20px;">INDICADORES OPERACIONAIS (FUNIL)</h2>
                        <div class="funil-indicators-grid">
                            <!-- Linha superior -->
                            <div class="funil-indicator-card">
                                <span class="funil-card-title">TOTAL DE LEADS CRIADOS</span>
                                <span class="funil-card-value" id="funil-total-leads">282</span>
                            </div>
                            <div class="funil-indicator-card">
                                <span class="funil-card-title">QUALIFICA√á√ÉO COMISS√ÉO</span>
                                <span class="funil-card-value" id="funil-qualificacao-comissao">0</span>
                            </div>
                            <div class="funil-indicator-card">
                                <span class="funil-card-title">REUNI√ÉO REALIZADA</span>
                                <span class="funil-card-value" id="funil-reuniao-realizada">0</span>
                            </div>
                            <div class="funil-indicator-card">
                                <span class="funil-card-title">PROPOSTAS ENVIADAS</span>
                                <span class="funil-card-value" id="funil-propostas-enviadas">23</span>
                            </div>
                            <div class="funil-indicator-card">
                                <span class="funil-card-title">CONTRATOS FECHADOS COMISS√ÉO</span>
                                <span class="funil-card-value" id="funil-contratos-fechados">3</span>
                            </div>
                            
                            <!-- Linha inferior -->
                            <div class="funil-indicator-card funil-card-wide">
                                <span class="funil-card-title">LEADS PERDIDOS</span>
                                <span class="funil-card-value" id="funil-leads-perdidos">24</span>
                            </div>
                            <div class="funil-indicator-card funil-card-wide funil-card-highlight">
                                <span class="funil-card-title">LEADS DESCARTADOS</span>
                                <span class="funil-card-value" id="funil-leads-desqualificados">25</span>
                            </div>
                        </div>
                    </section>

                    <!-- Se√ß√£o de Capta√ß√µes (placeholder para futuro) -->
                    <section class="kpi-container" id="funil-captacoes-section" style="display: block;">
                        <h2 style="grid-column: span 12; font-size: 1.4em; color: #ffc107; margin-bottom: 20px;">CAPTA√á√ïES</h2>
                        <div class="funil-captacoes-placeholder">
                            <p>Se√ß√£o em desenvolvimento - Indicadores de capta√ß√µes ser√£o adicionados em breve</p>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script src="date-picker.js"></script>
    <script>
        $(document).ready(function() {
            // Remove a l√≥gica de login antiga - agora √© gerenciada pelo script.js
            // A autentica√ß√£o √© feita atrav√©s da planilha de acesso compartilhada
        });
    </script>
</body>
</html>